# HG changeset patch
# Parent 588b1bc232e15d9d1b80f17de41f96140e65aa00
# User Jose Antonio Olivera Ortega <josea.olivera@gmail.com>
Bug 1134329 - Service worker install and activate events not fired when updating the service worker javascript file. r=nsm

diff --git a/dom/workers/ServiceWorkerManager.cpp b/dom/workers/ServiceWorkerManager.cpp
--- a/dom/workers/ServiceWorkerManager.cpp
+++ b/dom/workers/ServiceWorkerManager.cpp
@@ -501,24 +501,24 @@ public:
       swm->AppendPendingOperation(runnable);
       return;
     }
 
     if (mJobType == REGISTER_JOB) {
       mRegistration = swm->GetRegistration(mScope);
 
       if (mRegistration) {
-        nsRefPtr<ServiceWorkerInfo> newest = mRegistration->Newest();
-        if (newest && mScriptSpec.Equals(newest->ScriptSpec()) &&
-            mScriptSpec.Equals(mRegistration->mScriptSpec)) {
-          mRegistration->mPendingUninstall = false;
-          Succeed();
-          Done(NS_OK);
-          return;
-        }
+        // nsRefPtr<ServiceWorkerInfo> newest = mRegistration->Newest();
+        // if (newest && mScriptSpec.Equals(newest->ScriptSpec()) &&
+        //     mScriptSpec.Equals(mRegistration->mScriptSpec)) {
+        //   mRegistration->mPendingUninstall = false;
+        //   Succeed();
+        //   Done(NS_OK);
+        //   return;
+        // }
       } else {
         mRegistration = swm->CreateNewRegistration(mScope, mPrincipal);
       }
 
       mRegistration->mScriptSpec = mScriptSpec;
       swm->StoreRegistration(mPrincipal, mRegistration);
     } else {
       MOZ_ASSERT(mJobType == UPDATE_JOB);
